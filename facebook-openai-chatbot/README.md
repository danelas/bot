# Facebook Messenger Chatbot with OpenAI Chat API

This project creates a Facebook Messenger chatbot that uses OpenAI's Chat Completion API to generate responses and saves conversation history to Google Sheets.

## Features

- Integrates Facebook Messenger with OpenAI's GPT models
- Records all conversations in Google Sheets for analysis
- Supports structured conversation flows for specific use cases
- Easy to deploy on any server with webhook support

## Setup Instructions

### Prerequisites

- Python 3.8 or higher
- Facebook Developer Account and App
- OpenAI API key
- Google Cloud Project with Sheets API enabled

### Installation

1. Clone this repository
2. Install dependencies:
   ```
   pip install -r requirements.txt
   ```
3. Copy `.env.template` to `.env` and fill in your API keys and configuration:
   ```
   cp .env.template .env
   ```

### Facebook App Setup

1. Create a Facebook App at [developers.facebook.com](https://developers.facebook.com/)
2. Set up a Facebook Page and connect it to your app
3. Set up Messenger in your app and generate a Page Access Token
4. Configure the Webhook URL to point to your server's `/webhook` endpoint
5. Set a verify token (can be any string) and add it to your `.env` file

### OpenAI Setup

1. Get an API key from the OpenAI platform
2. Add the API key to your `.env` file
3. The application uses the GPT-4 model by default, but you can change it in the `openai_helper.py` file

### Google Sheets Setup

1. Create a Google Cloud Project and enable the Google Sheets API
2. Create a service account and download the credentials JSON file
3. Share a Google Sheet with the service account email
4. Add the Sheet ID to your `.env` file

## Running the Application

To run the application locally:

```
python app.py
```

For production deployment, consider using Gunicorn or uWSGI with a reverse proxy like Nginx.

## Webhook Testing

You can use tools like ngrok to test your webhook locally:

```
ngrok http 5000
```

Then update your Facebook webhook URL with the ngrok URL.

## Testing the Chatbot

Once everything is set up, users can message your Facebook Page, and they'll receive responses generated by your OpenAI Chat Completion API.

## Troubleshooting

- If messages aren't being received, check your webhook configuration
- If responses aren't being sent, check your Page Access Token
- For OpenAI issues, verify your API key
- For Google Sheets issues, ensure the service account has proper permissions
